CREATE DATABASE Deso9_LuyenHaiDang
--Quản lý thi lại, học lại sinh viên--
USE Deso9_LuyenHaiDang
--Tạo cơ sở dữ liệu--
--Tạo bảng lớp học--
CREATE TABLE Class
(
IDCLASS CHAR(10),
NAMECLASS NVARCHAR(50) UNIQUE,
NUMBERSTUDENT INT,
CONSTRAINT PK_CLASS PRIMARY KEY(IDCLASS)
)
--Tạo bảng sinh viên--
CREATE TABLE Student
(
IDSTUDENT CHAR(10),
NAMESTUDENT NVARCHAR(30),
BIRTHDAY DATE CHECK(YEAR(BIRTHDAY)<=1995 AND YEAR(BIRTHDAY)>=1990),
SEX NVARCHAR(3) CHECK(SEX IN (N'Nam',N'Nữ')),
ANDRESS NVARCHAR(30),
NUMBERPHONE NVARCHAR(10),
EMAIL NVARCHAR(30),
IDCLASS CHAR(10) FOREIGN KEY REFERENCES CLASS(IDCLASS) ON DELETE CASCADE ON UPDATE CASCADE,
CONSTRAINT PK_STUDENT PRIMARY KEY(IDSTUDENT)
)

--Tạo bảng giáo viên--
CREATE TABLE Teacher
(
IDTEACHER CHAR(10),
NAMETEACHER NVARCHAR(30),
BIRTHDAY DATE CHECK(YEAR(BIRTHDAY)<=1995 AND YEAR(BIRTHDAY)>=1990),
SEX NVARCHAR(3) CHECK(SEX IN (N'Nam',N'Nữ')),
ANDRESS NVARCHAR(30),
NUMBERPHONE NVARCHAR(10),
EMAIL NVARCHAR(30),
CONSTRAINT PK_TEACHER PRIMARY KEY(IDTEACHER)
)
--Tạo bảng môn học--
CREATE TABLE Subject
(
IDSUBJECT CHAR(10),
NAMESUBJECT NVARCHAR(30),
NUMBERCREDITS INT CHECK(NUMBERCREDITS > 0 AND NUMBERCREDITS < 16)
CONSTRAINT PK_SUBJECT PRIMARY KEY(IDSUBJECT)
)
--Tạo bảng lớp học lại--
CREATE TABLE ReTestClass
(
IDCLASS CHAR(10),
NAMECLASS NVARCHAR(30),
IDSUBJECT CHAR(10) FOREIGN KEY REFERENCES SUBJECT(IDSUBJECT) ON DELETE CASCADE ON UPDATE CASCADE,
IDTEACHER CHAR(10) FOREIGN KEY REFERENCES TEACHER(IDTEACHER) ON DELETE CASCADE ON UPDATE CASCADE,
NUMBERSTUDENT INT,
SEMESTER INT CHECK(SEMESTER >0 AND SEMESTER<3),
YEARSCHOOL NVARCHAR(30),
STATUSRETESTCLASS NVARCHAR(30) CHECK(STATUSRETESTCLASS IN (N'ĐÓNG',N'MỞ')),
CONSTRAINT PU_RETESTCLASS UNIQUE(IDCLASS,YEARSCHOOL,SEMESTER),
CONSTRAINT PK_RETESTCLASS PRIMARY KEY(IDCLASS),
)
--Tạo bảng đăng ký học lại--
CREATE TABLE RegisterReTest
(
IDSTUDENT CHAR(10) FOREIGN KEY REFERENCES STUDENT(IDSTUDENT) ON DELETE CASCADE ON UPDATE CASCADE,
IDCLASS CHAR(10) FOREIGN KEY REFERENCES RETESTCLASS(IDCLASS) ON DELETE CASCADE ON UPDATE CASCADE,
STATUS NVARCHAR(30),
CONSTRAINT PK_RegisterReTest PRIMARY KEY(IDSTUDENT,IDCLASS)
)
--Tạo bảng nộp tiền--
CREATE TABLE Payment
(
IDSTUDENT CHAR(10),
IDCLASS CHAR(10),
NUMBERPAYMENT INT,
DAYPAYMENT DATE,
CONSTRAINT FK_PAYMENT FOREIGN KEY(IDSTUDENT, IDCLASS) REFERENCES RegisterReTest(IDSTUDENT, IDCLASS),
CONSTRAINT PK_payment PRIMARY KEY(IDSTUDENT,IDCLASS)
)
--Tạo bảng điểm thi--
CREATE TABLE Scores
(
MARK1 INT CHECK(MARK1 >=0 AND MARK1<=10),
MARK2 INT CHECK(MARK2 >=0 AND MARK2<=10),
IDSTUDENT CHAR(10),
IDCLASS CHAR(10),
CONSTRAINT FK_SCORES FOREIGN KEY(IDSTUDENT, IDCLASS) REFERENCES RegisterReTest(IDSTUDENT, IDCLASS),
CONSTRAINT PK_SCORES PRIMARY KEY(IDSTUDENT,IDCLASS)
)

--Thêm dữ liệu vào các bảng--
--Thêm dữ liệu bảng lớp--
INSERT INTO Class(IDCLASS,NAMECLASS)VALUES('125201',N'SEK18.1')
INSERT INTO Class(IDCLASS,NAMECLASS)VALUES('125202',N'SEK18.2')
INSERT INTO Class(IDCLASS,NAMECLASS)VALUES('125203',N'SEK18.3')
INSERT INTO Class(IDCLASS,NAMECLASS)VALUES('125204',N'SEK18.4')
INSERT INTO Class(IDCLASS,NAMECLASS)VALUES('125205',N'SEK18.5')
INSERT INTO Class(IDCLASS,NAMECLASS)VALUES('125206',N'SEK18.6')
INSERT INTO Class(IDCLASS,NAMECLASS)VALUES('125207',N'SEK18.7')
INSERT INTO Class(IDCLASS,NAMECLASS)VALUES('125208',N'SEK18.8')
INSERT INTO Class(IDCLASS,NAMECLASS)VALUES('125209',N'SEK18.9')
INSERT INTO Class(IDCLASS,NAMECLASS)VALUES('125210',N'SEK18.10')
--Thêm dữ liệu bảng sinh viên--
INSERT INTO Student(IDSTUDENT,NAMESTUDENT,BIRTHDAY,SEX,ANDRESS,NUMBERPHONE,EMAIL,IDCLASS)VALUES('12520063',N'Luyện Hải Đăng','2002-06-10',N'Nam',N'Hưng Yên',N'0922002360',N'luyenhaidangit@gmail.com',N'125201')
INSERT INTO Student(IDSTUDENT,NAMESTUDENT,BIRTHDAY,SEX,ANDRESS,NUMBERPHONE,EMAIL,IDCLASS)VALUES('12520064',N'Đào Xuân Đức','2002-06-11',N'Nam',N'Hưng Yên',N'0922002361',N'luyenhaidangit1@gmail.com',N'125201')
INSERT INTO Student(IDSTUDENT,NAMESTUDENT,BIRTHDAY,SEX,ANDRESS,NUMBERPHONE,EMAIL,IDCLASS)VALUES('12520065',N'Nguyễn Đăng Đạo','2002-06-12',N'Nam',N'Hưng Yên',N'0922002362',N'luyenhaidangit2@gmail.com',N'125201')
INSERT INTO Student(IDSTUDENT,NAMESTUDENT,BIRTHDAY,SEX,ANDRESS,NUMBERPHONE,EMAIL,IDCLASS)VALUES('12520066',N'Đỗ Như Nghĩa','2002-06-13',N'Nam',N'Hưng Yên',N'0922002363',N'luyenhaidangit3@gmail.com',N'125201')
INSERT INTO Student(IDSTUDENT,NAMESTUDENT,BIRTHDAY,SEX,ANDRESS,NUMBERPHONE,EMAIL,IDCLASS)VALUES('12520067',N'Nguyễn Văn Mạnh','2002-06-14',N'Nam',N'Hưng Yên',N'0922002364',N'luyenhaidangit4@gmail.com',N'125201')
INSERT INTO Student(IDSTUDENT,NAMESTUDENT,BIRTHDAY,SEX,ANDRESS,NUMBERPHONE,EMAIL,IDCLASS)VALUES('12520068',N'Đinh Hoàng Anh','2002-06-15',N'Nam',N'Hưng Yên',N'0922002365',N'luyenhaidangit5@gmail.com',N'125202')
INSERT INTO Student(IDSTUDENT,NAMESTUDENT,BIRTHDAY,SEX,ANDRESS,NUMBERPHONE,EMAIL,IDCLASS)VALUES('12520069',N'Ngô Quang Hưng','2002-06-16',N'Nam',N'Hưng Yên',N'0922002366',N'luyenhaidangit6@gmail.com',N'125202')
INSERT INTO Student(IDSTUDENT,NAMESTUDENT,BIRTHDAY,SEX,ANDRESS,NUMBERPHONE,EMAIL,IDCLASS)VALUES('12520070',N'Luyện Minh Quân','2002-06-18',N'Nam',N'Hưng Yên',N'0922002367',N'luyenhaidangit5@gmail.com',N'125202')
INSERT INTO Student(IDSTUDENT,NAMESTUDENT,BIRTHDAY,SEX,ANDRESS,NUMBERPHONE,EMAIL,IDCLASS)VALUES('12520071',N'Phạm Xuân Tuyển','2002-06-15',N'Nam',N'Hưng Yên',N'0922002365',N'luyenhaidangit5@gmail.com',N'125203')
INSERT INTO Student(IDSTUDENT,NAMESTUDENT,BIRTHDAY,SEX,ANDRESS,NUMBERPHONE,EMAIL,IDCLASS)VALUES('12520072',N'Nguyễn Thanh Tùng','2002-06-15',N'Nam',N'Hưng Yên',N'0922002365',N'luyenhaidangit5@gmail.com',N'125203')
--Thêm dữ liệu bảng giáo viên--
INSERT INTO Teacher(IDTEACHER,NAMETEACHER,BIRTHDAY,SEX,ANDRESS,NUMBERPHONE,EMAIL)VALUES('1210',N'Trịnh Thị Nhị','1980-06-10',N'Nữ',N'Hưng Yên',N'0922002360',N'luyenhaidangit@gmail.com')
INSERT INTO Teacher(IDTEACHER,NAMETEACHER,BIRTHDAY,SEX,ANDRESS,NUMBERPHONE,EMAIL)VALUES('1211',N'Nguyễn Hữu Đông','1980-06-11',N'Nam',N'Hưng Yên',N'0922002360',N'luyenhaidangit@gmail.com')
INSERT INTO Teacher(IDTEACHER,NAMETEACHER,BIRTHDAY,SEX,ANDRESS,NUMBERPHONE,EMAIL)VALUES('1212',N'Ngô Thanh Huyền','1980-06-10',N'Nữ',N'Hưng Yên',N'0922002360',N'luyenhaidangit@gmail.com')
INSERT INTO Teacher(IDTEACHER,NAMETEACHER,BIRTHDAY,SEX,ANDRESS,NUMBERPHONE,EMAIL)VALUES('1213',N'Trần Đỗ Thu Hà','1980-06-10',N'Nữ',N'Hưng Yên',N'0922002360',N'luyenhaidangit@gmail.com')
INSERT INTO Teacher(IDTEACHER,NAMETEACHER,BIRTHDAY,SEX,ANDRESS,NUMBERPHONE,EMAIL)VALUES('1214',N'Đỗ Hoàng Điệp','1980-06-10',N'Nữ',N'Hưng Yên',N'0922002360',N'luyenhaidangit@gmail.com')
INSERT INTO Teacher(IDTEACHER,NAMETEACHER,BIRTHDAY,SEX,ANDRESS,NUMBERPHONE,EMAIL)VALUES('1215',N'Nguyễn Văn Chiến','1980-06-10',N'Nam',N'Hưng Yên',N'0922002360',N'luyenhaidangit@gmail.com')
INSERT INTO Teacher(IDTEACHER,NAMETEACHER,BIRTHDAY,SEX,ANDRESS,NUMBERPHONE,EMAIL)VALUES('1216',N'Trần Thu Hà','1980-06-10',N'Nữ',N'Hưng Yên',N'0922002360',N'luyenhaidangit@gmail.com')
INSERT INTO Teacher(IDTEACHER,NAMETEACHER,BIRTHDAY,SEX,ANDRESS,NUMBERPHONE,EMAIL)VALUES('1217',N'Đào Anh Hiển','1980-06-10',N'Nam',N'Hưng Yên',N'0922002360',N'luyenhaidangit@gmail.com')
INSERT INTO Teacher(IDTEACHER,NAMETEACHER,BIRTHDAY,SEX,ANDRESS,NUMBERPHONE,EMAIL)VALUES('1218',N'Nguyễn Thị Huyền','1980-06-10',N'Nữ',N'Hưng Yên',N'0922002360',N'luyenhaidangit@gmail.com')
INSERT INTO Teacher(IDTEACHER,NAMETEACHER,BIRTHDAY,SEX,ANDRESS,NUMBERPHONE,EMAIL)VALUES('1219',N'Đỗ Quỳnh Trang','1980-06-10',N'Nữ',N'Hưng Yên',N'0922002360',N'luyenhaidangit@gmail.com')
--Thêm dữ liệu bảng môn học--
INSERT INTO Subject(IDSUBJECT,NAMESUBJECT,NUMBERCREDITS)VALUES('1100',N'Hệ quản trị cơ sở dữ liệu',3)
INSERT INTO Subject(IDSUBJECT,NAMESUBJECT,NUMBERCREDITS)VALUES('1101',N'Lập trình hướng đối tượng',4)
INSERT INTO Subject(IDSUBJECT,NAMESUBJECT,NUMBERCREDITS)VALUES('1102',N'Cơ sở dữ liệu',4)
INSERT INTO Subject(IDSUBJECT,NAMESUBJECT,NUMBERCREDITS)VALUES('1103',N'Tiếng anh 1',2)
INSERT INTO Subject(IDSUBJECT,NAMESUBJECT,NUMBERCREDITS)VALUES('1104',N'Thiết kế web với HTML/CSS/JS',4)
INSERT INTO Subject(IDSUBJECT,NAMESUBJECT,NUMBERCREDITS)VALUES('1105',N'C# nâng cao',3)
INSERT INTO Subject(IDSUBJECT,NAMESUBJECT,NUMBERCREDITS)VALUES('1106',N'Cấu trúc dữ liệu và giải thuật',3)
INSERT INTO Subject(IDSUBJECT,NAMESUBJECT,NUMBERCREDITS)VALUES('1107',N'Lập trình căn bản',3)
INSERT INTO Subject(IDSUBJECT,NAMESUBJECT,NUMBERCREDITS)VALUES('1108',N'Triết học',3)
INSERT INTO Subject(IDSUBJECT,NAMESUBJECT,NUMBERCREDITS)VALUES('1109',N'Kinh tế chính trị',2)
--Thêm dữ liệu bảng lớp học cải thiện--
INSERT INTO ReTestClass(IDCLASS,NAMECLASS,IDSUBJECT,IDTEACHER,YEARSCHOOL,SEMESTER)VALUES('101100',N'CT101100','1100','1210','2021',2)
INSERT INTO ReTestClass(IDCLASS,NAMECLASS,IDSUBJECT,IDTEACHER,YEARSCHOOL,SEMESTER)VALUES('101101',N'CT101101','1100','1210','2021',2)
INSERT INTO ReTestClass(IDCLASS,NAMECLASS,IDSUBJECT,IDTEACHER,YEARSCHOOL,SEMESTER)VALUES('101102',N'CT101102','1101','1210','2021',2)
INSERT INTO ReTestClass(IDCLASS,NAMECLASS,IDSUBJECT,IDTEACHER,YEARSCHOOL,SEMESTER)VALUES('101103',N'CT101100','1101','1211','2021',2)
INSERT INTO ReTestClass(IDCLASS,NAMECLASS,IDSUBJECT,IDTEACHER,YEARSCHOOL,SEMESTER)VALUES('101104',N'CT101103','1101','1212','2021',2)
INSERT INTO ReTestClass(IDCLASS,NAMECLASS,IDSUBJECT,IDTEACHER,YEARSCHOOL,SEMESTER)VALUES('101105',N'CT101104','1102','1210','2021',2)
INSERT INTO ReTestClass(IDCLASS,NAMECLASS,IDSUBJECT,IDTEACHER,YEARSCHOOL,SEMESTER)VALUES('101106',N'CT101100','1102','1212','2021',2)
INSERT INTO ReTestClass(IDCLASS,NAMECLASS,IDSUBJECT,IDTEACHER,YEARSCHOOL,SEMESTER)VALUES('101107',N'CT101100','1103','1210','2021',2)
INSERT INTO ReTestClass(IDCLASS,NAMECLASS,IDSUBJECT,IDTEACHER,YEARSCHOOL,SEMESTER)VALUES('101108',N'CT101108','1104','1210','2021',2)
INSERT INTO ReTestClass(IDCLASS,NAMECLASS,IDSUBJECT,IDTEACHER,YEARSCHOOL,SEMESTER)VALUES('101109',N'CT101109','1105','1210','2021',2)
--Thêm dữ liệu bảng đăng ký học lại--
INSERT INTO RegisterReTest(IDSTUDENT,IDCLASS)VALUES('12520063',N'101100')
INSERT INTO RegisterReTest(IDSTUDENT,IDCLASS)VALUES('12520064',N'101100')
INSERT INTO RegisterReTest(IDSTUDENT,IDCLASS)VALUES('12520063',N'101101')
INSERT INTO RegisterReTest(IDSTUDENT,IDCLASS)VALUES('12520065',N'101100')
INSERT INTO RegisterReTest(IDSTUDENT,IDCLASS)VALUES('12520066',N'101100')
INSERT INTO RegisterReTest(IDSTUDENT,IDCLASS)VALUES('12520064',N'101101')
INSERT INTO RegisterReTest(IDSTUDENT,IDCLASS)VALUES('12520065',N'101101')
INSERT INTO RegisterReTest(IDSTUDENT,IDCLASS)VALUES('12520063',N'101103')
INSERT INTO RegisterReTest(IDSTUDENT,IDCLASS)VALUES('12520064',N'101103')
INSERT INTO RegisterReTest(IDSTUDENT,IDCLASS)VALUES('12520066',N'101103')
--Nhập dữ liệu bảng Payment--
INSERT INTO Payment(IDSTUDENT,IDCLASS,NUMBERPAYMENT,DAYPAYMENT)VALUES('12520063',N'101100',1000000,'2022-06-18')
INSERT INTO Payment(IDSTUDENT,IDCLASS,NUMBERPAYMENT,DAYPAYMENT)VALUES('12520063',N'101101',600000,'2022-06-18')
INSERT INTO Payment(IDSTUDENT,IDCLASS,NUMBERPAYMENT,DAYPAYMENT)VALUES('12520064',N'101100',6000000,'2022-06-18')
INSERT INTO Payment(IDSTUDENT,IDCLASS,NUMBERPAYMENT,DAYPAYMENT)VALUES('12520065',N'101100',1000000,'2022-06-18')
INSERT INTO Payment(IDSTUDENT,IDCLASS,NUMBERPAYMENT,DAYPAYMENT)VALUES('12520066',N'101100',1000000,'2022-06-18')
INSERT INTO Payment(IDSTUDENT,IDCLASS,NUMBERPAYMENT,DAYPAYMENT)VALUES('12520064',N'101101',1000000,'2022-06-18')
INSERT INTO Payment(IDSTUDENT,IDCLASS,NUMBERPAYMENT,DAYPAYMENT)VALUES('12520065',N'101101',800000,'2022-06-18')
INSERT INTO Payment(IDSTUDENT,IDCLASS,NUMBERPAYMENT,DAYPAYMENT)VALUES('12520063',N'101103',1000000,'2022-06-18')
INSERT INTO Payment(IDSTUDENT,IDCLASS,NUMBERPAYMENT,DAYPAYMENT)VALUES('12520064',N'101103',800000,'2022-06-18')
INSERT INTO Payment(IDSTUDENT,IDCLASS,NUMBERPAYMENT,DAYPAYMENT)VALUES('12520066',N'101103',1000000,'2022-06-18')
--Nhập dữ liệu bảng Scores--
INSERT INTO Scores(MARK1,MARK2,IDSTUDENT,IDCLASS)VALUES(9,9,'12520063',N'101100')
INSERT INTO Scores(MARK1,MARK2,IDSTUDENT,IDCLASS)VALUES(8,9,'12520063',N'101101')
INSERT INTO Scores(MARK1,MARK2,IDSTUDENT,IDCLASS)VALUES(9,10,'12520064',N'101100')
INSERT INTO Scores(MARK1,MARK2,IDSTUDENT,IDCLASS)VALUES(8,9,'12520065',N'101100')
INSERT INTO Scores(MARK1,MARK2,IDSTUDENT,IDCLASS)VALUES(9,9,'12520066',N'101100')
INSERT INTO Scores(MARK1,MARK2,IDSTUDENT,IDCLASS)VALUES(7,9,'12520064',N'101101')
INSERT INTO Scores(MARK1,MARK2,IDSTUDENT,IDCLASS)VALUES(7,9,'12520065',N'101101')
INSERT INTO Scores(MARK1,MARK2,IDSTUDENT,IDCLASS)VALUES(8,9,'12520063',N'101103')
INSERT INTO Scores(MARK1,MARK2,IDSTUDENT,IDCLASS)VALUES(6,6,'12520064',N'101103')
INSERT INTO Scores(MARK1,MARK2,IDSTUDENT,IDCLASS)VALUES(9,2,'12520066',N'101103')

SELECT * FROM Class
SELECT * FROM Student
SELECT * FROM Teacher
SELECT * FROM Subject
SELECT * FROM ReTestClass
SELECT * FROM RegisterReTest
SELECT * FROM Payment
SELECT * FROM Scores
